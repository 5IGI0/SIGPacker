/**
 * This file is part of SIGPacker. SIGPacker is free software:
 * you can redistribute it and/or modify it under the terms of
 * the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License,
 * or (at your option) any later version.
 *
 * SIGPacker is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 *
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with SIGPacker.
 * If not, see <https://www.gnu.org/licenses/>. 
 *
 * Copyright 2024, 2025 5IGI0 / Ethan L. C. Lorenzetti
**/

#ifndef FMT_PE_DEFINES_H
#define FMT_PE_DEFINES_H

#define PE_SIGNATURE 0x00004550

#define IMAGE_FILE_RELOCS_STRIPPED          0x0001 /* No relocation info */
#define IMAGE_FILE_EXECUTABLE_IMAGE	        0x0002
#define IMAGE_FILE_LINE_NUMS_STRIPPED       0x0004
#define IMAGE_FILE_LOCAL_SYMS_STRIPPED      0x0008
#define IMAGE_FILE_AGGRESIVE_WS_TRIM	    0x0010
#define IMAGE_FILE_LARGE_ADDRESS_AWARE	    0x0020
#define IMAGE_FILE_16BIT_MACHINE	        0x0040
#define IMAGE_FILE_BYTES_REVERSED_LO	    0x0080
#define IMAGE_FILE_32BIT_MACHINE	        0x0100
#define IMAGE_FILE_DEBUG_STRIPPED	        0x0200
#define IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP	0x0400
#define IMAGE_FILE_NET_RUN_FROM_SWAP	    0x0800
#define IMAGE_FILE_SYSTEM		            0x1000
#define IMAGE_FILE_DLL			            0x2000
#define IMAGE_FILE_UP_SYSTEM_ONLY	        0x4000
#define IMAGE_FILE_BYTES_REVERSED_HI	    0x8000

/* These are the settings of the Machine field. */
#define	IMAGE_FILE_MACHINE_UNKNOWN	    0
#define	IMAGE_FILE_MACHINE_I860		    0x014d
#define	IMAGE_FILE_MACHINE_I386		    0x014c
#define	IMAGE_FILE_MACHINE_R3000	    0x0162
#define	IMAGE_FILE_MACHINE_R4000	    0x0166
#define	IMAGE_FILE_MACHINE_R10000	    0x0168
#define	IMAGE_FILE_MACHINE_WCEMIPSV2	0x0169
#define	IMAGE_FILE_MACHINE_ALPHA	    0x0184
#define	IMAGE_FILE_MACHINE_SH3		    0x01a2
#define	IMAGE_FILE_MACHINE_SH3DSP	    0x01a3
#define	IMAGE_FILE_MACHINE_SH3E		    0x01a4
#define	IMAGE_FILE_MACHINE_SH4		    0x01a6
#define	IMAGE_FILE_MACHINE_SH5		    0x01a8
#define	IMAGE_FILE_MACHINE_ARM		    0x01c0
#define	IMAGE_FILE_MACHINE_THUMB	    0x01c2
#define	IMAGE_FILE_MACHINE_ARMNT	    0x01c4
#define	IMAGE_FILE_MACHINE_ARM64	    0xaa64
#define	IMAGE_FILE_MACHINE_AM33		    0x01d3
#define	IMAGE_FILE_MACHINE_POWERPC	    0x01f0
#define	IMAGE_FILE_MACHINE_POWERPCFP	0x01f1
#define	IMAGE_FILE_MACHINE_IA64		    0x0200
#define	IMAGE_FILE_MACHINE_MIPS16	    0x0266
#define	IMAGE_FILE_MACHINE_ALPHA64	    0x0284
#define	IMAGE_FILE_MACHINE_MIPSFPU	    0x0366
#define	IMAGE_FILE_MACHINE_MIPSFPU16	0x0466
#define	IMAGE_FILE_MACHINE_AXP64	    IMAGE_FILE_MACHINE_ALPHA64
#define	IMAGE_FILE_MACHINE_TRICORE	    0x0520
#define	IMAGE_FILE_MACHINE_CEF		    0x0cef
#define	IMAGE_FILE_MACHINE_EBC		    0x0ebc
#define	IMAGE_FILE_MACHINE_AMD64	    0x8664
#define	IMAGE_FILE_MACHINE_M32R		    0x9041
#define	IMAGE_FILE_MACHINE_CEE		    0xc0ee

#define	IMAGE_SIZEOF_FILE_HEADER		    20
#define IMAGE_SIZEOF_ROM_OPTIONAL_HEADER	56
#define IMAGE_SIZEOF_STD_OPTIONAL_HEADER	28
#define IMAGE_SIZEOF_NT_OPTIONAL32_HEADER 	224
#define IMAGE_SIZEOF_NT_OPTIONAL64_HEADER 	240
#define IMAGE_SIZEOF_SHORT_NAME 		    8
#define IMAGE_SIZEOF_SECTION_HEADER 		40
#define IMAGE_SIZEOF_SYMBOL 			    18
#define IMAGE_SIZEOF_AUX_SYMBOL 		    18
#define IMAGE_SIZEOF_RELOCATION 		    10
#define IMAGE_SIZEOF_BASE_RELOCATION 		8
#define IMAGE_SIZEOF_LINENUMBER 		    6
#define IMAGE_SIZEOF_ARCHIVE_MEMBER_HDR 	60

/* Possible Magic values */
#define IMAGE_NT_OPTIONAL_HDR32_MAGIC      0x10b
#define IMAGE_NT_OPTIONAL_HDR64_MAGIC      0x20b
#define IMAGE_ROM_OPTIONAL_HDR_MAGIC       0x107

/* These are indexes into the DataDirectory array */
#define IMAGE_FILE_EXPORT_DIRECTORY		    0
#define IMAGE_FILE_IMPORT_DIRECTORY		    1
#define IMAGE_FILE_RESOURCE_DIRECTORY		2
#define IMAGE_FILE_EXCEPTION_DIRECTORY		3
#define IMAGE_FILE_SECURITY_DIRECTORY		4
#define IMAGE_FILE_BASE_RELOCATION_TABLE	5
#define IMAGE_FILE_DEBUG_DIRECTORY		    6
#define IMAGE_FILE_DESCRIPTION_STRING		7
#define IMAGE_FILE_MACHINE_VALUE		    8  /* Mips */
#define IMAGE_FILE_THREAD_LOCAL_STORAGE		9
#define IMAGE_FILE_CALLBACK_DIRECTORY		10

/* Directory Entries, indices into the DataDirectory array */

#define	IMAGE_DIRECTORY_ENTRY_EXPORT		    0
#define	IMAGE_DIRECTORY_ENTRY_IMPORT		    1
#define	IMAGE_DIRECTORY_ENTRY_RESOURCE		    2
#define	IMAGE_DIRECTORY_ENTRY_EXCEPTION		    3
#define	IMAGE_DIRECTORY_ENTRY_SECURITY		    4
#define	IMAGE_DIRECTORY_ENTRY_BASERELOC		    5
#define	IMAGE_DIRECTORY_ENTRY_DEBUG		        6
#define	IMAGE_DIRECTORY_ENTRY_COPYRIGHT		    7
#define	IMAGE_DIRECTORY_ENTRY_GLOBALPTR		    8   /* (MIPS GP) */
#define	IMAGE_DIRECTORY_ENTRY_TLS		        9
#define	IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG	    10
#define	IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT	    11
#define	IMAGE_DIRECTORY_ENTRY_IAT		        12  /* Import Address Table */
#define	IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT	    13
#define	IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR	14

/* Subsystem Values */

#define	IMAGE_SUBSYSTEM_UNKNOWN			            0
#define	IMAGE_SUBSYSTEM_NATIVE			            1
#define	IMAGE_SUBSYSTEM_WINDOWS_GUI		            2	/* Windows GUI subsystem */
#define	IMAGE_SUBSYSTEM_WINDOWS_CUI		            3	/* Windows character subsystem */
#define	IMAGE_SUBSYSTEM_OS2_CUI			            5
#define	IMAGE_SUBSYSTEM_POSIX_CUI		            7
#define	IMAGE_SUBSYSTEM_NATIVE_WINDOWS		        8	/* native Win9x driver */
#define	IMAGE_SUBSYSTEM_WINDOWS_CE_GUI		        9	/* Windows CE subsystem */
#define	IMAGE_SUBSYSTEM_EFI_APPLICATION		        10
#define	IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER	    11
#define	IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER	        12
#define	IMAGE_SUBSYSTEM_EFI_ROM			            13
#define	IMAGE_SUBSYSTEM_XBOX			            14
#define	IMAGE_SUBSYSTEM_WINDOWS_BOOT_APPLICATION	16

/* These defines are for the Characteristics bitfield. */
/* #define IMAGE_SCN_TYPE_REG			0x00000000 - Reserved */
/* #define IMAGE_SCN_TYPE_DSECT			0x00000001 - Reserved */
/* #define IMAGE_SCN_TYPE_NOLOAD		0x00000002 - Reserved */
/* #define IMAGE_SCN_TYPE_GROUP			0x00000004 - Reserved */
#define IMAGE_SCN_TYPE_NO_PAD			0x00000008 /* Reserved */
/* #define IMAGE_SCN_TYPE_COPY			0x00000010 - Reserved */

#define IMAGE_SCN_CNT_CODE			        0x00000020
#define IMAGE_SCN_CNT_INITIALIZED_DATA		0x00000040
#define IMAGE_SCN_CNT_UNINITIALIZED_DATA	0x00000080

#define	IMAGE_SCN_LNK_OTHER			0x00000100
#define	IMAGE_SCN_LNK_INFO			0x00000200
/* #define	IMAGE_SCN_TYPE_OVER		0x00000400 - Reserved */
#define	IMAGE_SCN_LNK_REMOVE			0x00000800
#define	IMAGE_SCN_LNK_COMDAT			0x00001000

/* 						0x00002000 - Reserved */
/* #define IMAGE_SCN_MEM_PROTECTED 		0x00004000 - Obsolete */
#define	IMAGE_SCN_MEM_FARDATA			0x00008000

/* #define IMAGE_SCN_MEM_SYSHEAP		0x00010000 - Obsolete */
#define	IMAGE_SCN_MEM_PURGEABLE			0x00020000
#define	IMAGE_SCN_MEM_16BIT			    0x00020000
#define	IMAGE_SCN_MEM_LOCKED			0x00040000
#define	IMAGE_SCN_MEM_PRELOAD			0x00080000

#define	IMAGE_SCN_ALIGN_1BYTES			0x00100000
#define	IMAGE_SCN_ALIGN_2BYTES			0x00200000
#define	IMAGE_SCN_ALIGN_4BYTES			0x00300000
#define	IMAGE_SCN_ALIGN_8BYTES			0x00400000
#define	IMAGE_SCN_ALIGN_16BYTES			0x00500000  /* Default */
#define	IMAGE_SCN_ALIGN_32BYTES			0x00600000
#define	IMAGE_SCN_ALIGN_64BYTES			0x00700000
#define	IMAGE_SCN_ALIGN_128BYTES		0x00800000
#define	IMAGE_SCN_ALIGN_256BYTES		0x00900000
#define	IMAGE_SCN_ALIGN_512BYTES		0x00A00000
#define	IMAGE_SCN_ALIGN_1024BYTES		0x00B00000
#define	IMAGE_SCN_ALIGN_2048BYTES		0x00C00000
#define	IMAGE_SCN_ALIGN_4096BYTES		0x00D00000
#define	IMAGE_SCN_ALIGN_8192BYTES		0x00E00000
/* 						0x00F00000 - Unused */
#define	IMAGE_SCN_ALIGN_MASK			0x00F00000

#define IMAGE_SCN_LNK_NRELOC_OVFL		0x01000000


#define IMAGE_SCN_MEM_DISCARDABLE		0x02000000
#define IMAGE_SCN_MEM_NOT_CACHED		0x04000000
#define IMAGE_SCN_MEM_NOT_PAGED			0x08000000
#define IMAGE_SCN_MEM_SHARED			0x10000000
#define IMAGE_SCN_MEM_EXECUTE			0x20000000
#define IMAGE_SCN_MEM_READ			    0x40000000
#define IMAGE_SCN_MEM_WRITE			    0x80000000

#define IMAGE_SYM_CLASS_END_OF_FUNCTION     (BYTE )-1
#define IMAGE_SYM_CLASS_NULL                0x0000
#define IMAGE_SYM_CLASS_AUTOMATIC           0x0001
#define IMAGE_SYM_CLASS_EXTERNAL            0x0002
#define IMAGE_SYM_CLASS_STATIC              0x0003
#define IMAGE_SYM_CLASS_REGISTER            0x0004
#define IMAGE_SYM_CLASS_EXTERNAL_DEF        0x0005
#define IMAGE_SYM_CLASS_LABEL               0x0006
#define IMAGE_SYM_CLASS_UNDEFINED_LABEL     0x0007
#define IMAGE_SYM_CLASS_MEMBER_OF_STRUCT    0x0008
#define IMAGE_SYM_CLASS_ARGUMENT            0x0009
#define IMAGE_SYM_CLASS_STRUCT_TAG          0x000A
#define IMAGE_SYM_CLASS_MEMBER_OF_UNION     0x000B
#define IMAGE_SYM_CLASS_UNION_TAG           0x000C
#define IMAGE_SYM_CLASS_TYPE_DEFINITION     0x000D
#define IMAGE_SYM_CLASS_UNDEFINED_STATIC    0x000E
#define IMAGE_SYM_CLASS_ENUM_TAG            0x000F
#define IMAGE_SYM_CLASS_MEMBER_OF_ENUM      0x0010
#define IMAGE_SYM_CLASS_REGISTER_PARAM      0x0011
#define IMAGE_SYM_CLASS_BIT_FIELD           0x0012

#define IMAGE_SYM_CLASS_FAR_EXTERNAL        0x0044
#define IMAGE_SYM_CLASS_BLOCK               0x0064
#define IMAGE_SYM_CLASS_FUNCTION            0x0065
#define IMAGE_SYM_CLASS_END_OF_STRUCT       0x0066
#define IMAGE_SYM_CLASS_FILE                0x0067
#define IMAGE_SYM_CLASS_SECTION             0x0068
#define IMAGE_SYM_CLASS_WEAK_EXTERNAL       0x0069

/* Possible Magic values */
#define IMAGE_NT_OPTIONAL_HDR32_MAGIC      0x10b
#define IMAGE_NT_OPTIONAL_HDR64_MAGIC      0x20b
#define IMAGE_ROM_OPTIONAL_HDR_MAGIC       0x107

/* These are the settings of the Machine field. */
#define	IMAGE_FILE_MACHINE_UNKNOWN	    0
#define	IMAGE_FILE_MACHINE_I860		    0x014d
#define	IMAGE_FILE_MACHINE_I386		    0x014c
#define	IMAGE_FILE_MACHINE_R3000	    0x0162
#define	IMAGE_FILE_MACHINE_R4000	    0x0166
#define	IMAGE_FILE_MACHINE_R10000	    0x0168
#define	IMAGE_FILE_MACHINE_WCEMIPSV2	0x0169
#define	IMAGE_FILE_MACHINE_ALPHA	    0x0184
#define	IMAGE_FILE_MACHINE_SH3		    0x01a2
#define	IMAGE_FILE_MACHINE_SH3DSP	    0x01a3
#define	IMAGE_FILE_MACHINE_SH3E		    0x01a4
#define	IMAGE_FILE_MACHINE_SH4		    0x01a6
#define	IMAGE_FILE_MACHINE_SH5		    0x01a8
#define	IMAGE_FILE_MACHINE_ARM		    0x01c0
#define	IMAGE_FILE_MACHINE_THUMB	    0x01c2
#define	IMAGE_FILE_MACHINE_ARMNT	    0x01c4
#define	IMAGE_FILE_MACHINE_ARM64	    0xaa64
#define	IMAGE_FILE_MACHINE_AM33		    0x01d3
#define	IMAGE_FILE_MACHINE_POWERPC	    0x01f0
#define	IMAGE_FILE_MACHINE_POWERPCFP	0x01f1
#define	IMAGE_FILE_MACHINE_IA64		    0x0200
#define	IMAGE_FILE_MACHINE_MIPS16	    0x0266
#define	IMAGE_FILE_MACHINE_ALPHA64	    0x0284
#define	IMAGE_FILE_MACHINE_MIPSFPU	    0x0366
#define	IMAGE_FILE_MACHINE_MIPSFPU16	0x0466
#define	IMAGE_FILE_MACHINE_AXP64	    IMAGE_FILE_MACHINE_ALPHA64
#define	IMAGE_FILE_MACHINE_TRICORE	    0x0520
#define	IMAGE_FILE_MACHINE_CEF		    0x0cef
#define	IMAGE_FILE_MACHINE_EBC		    0x0ebc
#define	IMAGE_FILE_MACHINE_AMD64	    0x8664
#define	IMAGE_FILE_MACHINE_M32R		    0x9041
#define	IMAGE_FILE_MACHINE_CEE		    0xc0ee

#define IMAGE_ORDINAL_FLAG64             (((ULONGLONG)0x80000000 << 32) | 0x00000000)
#define IMAGE_ORDINAL_FLAG32             0x80000000
#define IMAGE_SNAP_BY_ORDINAL64(ordinal) (((ordinal) & IMAGE_ORDINAL_FLAG64) != 0)
#define IMAGE_SNAP_BY_ORDINAL32(ordinal) (((ordinal) & IMAGE_ORDINAL_FLAG32) != 0)
#define IMAGE_ORDINAL64(ordinal)         ((ordinal) & 0xffff)
#define IMAGE_ORDINAL32(ordinal)         ((ordinal) & 0xffff)

#endif